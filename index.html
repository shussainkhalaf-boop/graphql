<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Reboot01 Profile</title>
  <link rel="icon" href="data:,">
  <link rel="stylesheet" href="./style.css?v=5" />
</head>
<body>
  <header class="app-header">
    <h1>Reboot01 Profile</h1>
    <button id="logoutBtn" class="ghost">Logout</button>
  </header>

  <main class="container">
    <section class="card">
      <h2>Sign in</h2>
      <form id="signinForm">
        <div class="row">
          <label for="login">Login</label>
          <input id="login" name="login" autocomplete="username" required />
        </div>
        <div class="row">
          <label for="password">Password</label>
          <input id="password" name="password" type="password" autocomplete="current-password" required />
        </div>
        <button type="submit" id="signinBtn">Sign in</button>
        <p id="signinHint" class="muted">Token will be stored locally and used for GraphQL requests.</p>
      </form>
      <div id="signinStatus" class="status"></div>
    </section>

    <section class="card">
      <h2>User</h2>
      <div class="grid-2" id="userBox">
        <div>
          <div class="label">Login</div>
          <div class="value" id="userLogin">—</div>
        </div>
        <div>
          <div class="label">User ID</div>
          <div class="value" id="userId">—</div>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Stats</h2>
      <div class="grid-3">
        <div>
          <div class="label">Total XP</div>
          <div class="value" id="totalXp">—</div>
        </div>
        <div>
          <div class="label">Audit Ratio</div>
          <div class="value" id="auditRatio">—</div>
        </div>
        <div>
          <div class="label">Projects</div>
          <div class="value" id="projectsCount">—</div>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Charts (SVG)</h2>
      <div class="charts">
        <figure>
          <figcaption>XP by Day</figcaption>
          <svg id="xpChart" viewBox="0 0 600 220" role="img" aria-label="XP by day area chart"></svg>
        </figure>
        <figure>
          <figcaption>Top Projects by XP</figcaption>
          <svg id="projectsChart" viewBox="0 0 600 220" role="img" aria-label="Top projects bar chart"></svg>
        </figure>
      </div>
    </section>

    <section class="card">
      <h2>Recent Projects</h2>
      <div id="projectsList" class="list"></div>
    </section>
  </main>

  <script>
    // --- Configure your endpoints here ---
    window.CONFIG = {
      // If you deploy the worker (worker.js), set WORKER_BASE to that URL.
      // The app will call `${WORKER_BASE}/signin` and `${WORKER_BASE}/graphql`.
      WORKER_BASE: localStorage.getItem("WORKER_BASE") || "",
      // Fallback: direct GraphQL endpoint (if your JWT already works for CORS).
      GRAPHQL_URL: "https://learn.reboot01.com/api/graphql-engine/v1/graphql"
    };
  </script>
  <script src="./graphs.js?v=5"></script>
  <script src="./app.js?v=5"></script>
</body>
</html>
